@model Bloggie.Web.Models.ViewModels.DashboardViewModel


@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Dashboard Page";
}

<div class="container-fluid">
<div class="row mt-2">
        @*  Total Blog Post *@
        <div class="col-md-6 col-xl-3">
            <div class="card border-0 rounded-3 eei" style=" box-shadow: rgba(50, 50, 93, 0.25) 0px 50px 100px -20px, rgba(0, 0, 0, 0.3) 0px 30px 60px -30px, rgba(10, 37, 64, 0.35) 0px -2px 6px 0px inset;background: linear-gradient(135deg, #fffbe6, #fff);">
                <div class="card-body">
                    <div class="d-flex align-items-center justify-content-between">
                        <div class="avatar-lg rounded-circle bg-warning bg-opacity-25 border border-warning d-flex align-items-center justify-content-center">
                            <i class="fe-eye text-warning" style="font-size: 24px;"></i>
                        </div>
                        <div class="text-end">
                            <h3 class="mb-0 fw-bold text-dark">
                                <span data-plugin="counterup">@Model.BlogCount</span>
                            </h3>
                            <small class="text-muted fs-5">Total Blog Posts</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        @* Total Tag *@
        <div class="col-md-6 col-xl-3">
            <div class="card border-0 rounded-3 rtu" style=" box-shadow: rgba(50, 50, 93, 0.25) 0px 50px 100px -20px, rgba(0, 0, 0, 0.3) 0px 30px 60px -30px, rgba(10, 37, 64, 0.35) 0px -2px 6px 0px inset;background: linear-gradient(135deg, #e6f7ff, #fff);">
                <div class="card-body">
                    <div class="d-flex align-items-center justify-content-between">
                        <div class="avatar-lg rounded-circle bg-info bg-opacity-25 border border-info d-flex align-items-center justify-content-center">
                            <i class="fe-tag text-info" style="font-size: 24px;"></i>
                        </div>
                        <div class="text-end">
                            <h3 class="mb-0 fw-bold text-dark">
                                <span data-plugin="counterup">@Model.TagCount</span>
                            </h3>
                            <small class="text-muted fs-5">Total Tags</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        @* Total User *@
        <div class="col-md-6 col-xl-3">
            <div class="card border-0 rounded-3 edty" style=" box-shadow: rgba(50, 50, 93, 0.25) 0px 50px 100px -20px, rgba(0, 0, 0, 0.3) 0px 30px 60px -30px, rgba(10, 37, 64, 0.35) 0px -2px 6px 0px inset;background: linear-gradient(135deg, #e6ffed, #fff);">
                <div class="card-body">
                    <div class="d-flex align-items-center justify-content-between">
                        <div class="avatar-lg rounded-circle bg-success bg-opacity-25 border border-success d-flex align-items-center justify-content-center">
                            <i class="fe-users text-success" style="font-size: 24px;"></i>
                        </div>
                        <div class="text-end">
                            <h3 class="mb-0 fw-bold text-dark">
                                <span data-plugin="counterup">@Model.UserCount</span>
                            </h3>
                            <small class="text-muted fs-5">Total Users</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        @* Total Admin *@
        <div class="col-md-6 col-xl-3">
            <div class="card border-0 rounded-3 tyu" style=" box-shadow: rgba(50, 50, 93, 0.25) 0px 50px 100px -20px, rgba(0, 0, 0, 0.3) 0px 30px 60px -30px, rgba(10, 37, 64, 0.35) 0px -2px 6px 0px inset;background: linear-gradient(135deg, #f3e8ff, #fff);">
                <div class="card-body">
                    <div class="d-flex align-items-center justify-content-between">
                        <div class="avatar-lg rounded-circle bg-purple bg-opacity-25 border border-purple d-flex align-items-center justify-content-center">
                            <i class="fe-shield text-purple" style="font-size: 24px;"></i>
                        </div>
                        <div class="text-end">
                            <h3 class="mb-0 fw-bold text-dark">
                                <span data-plugin="counterup">@Model.AdminCount</span>
                            </h3>
                            <small class="text-muted fs-5">Total Admins</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>


</div>



    <div class="row">
       
        
        <div class="col-md-6 col-xl-6">
            <div class="card border-0 rounded-3 p-3 ttio" style="background: linear-gradient(to right, #dffbf2, #f0f4ff); box-shadow: rgba(50, 50, 93, 0.25) 0px 50px 100px -20px, rgba(0, 0, 0, 0.3) 0px 30px 60px -30px, rgba(10, 37, 64, 0.35) 0px -2px 6px 0px inset; height: 460px;">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <div>
                        <h5 class="fw-semibold text-dark mb-1">📊 Website Visit Report</h5>
                        <small class="text-muted">Updated: @DateTime.Now.ToString("dd MMM yyyy")</small>
                    </div>
                    <span class="badge bg-info fs-6 px-3 py-2">📈 Live Visit</span>
                </div>

                <div id="visitChart" style="height: 260px;"></div>

                <div class="mt-3 row text-center">
                    <div class="col-md-4">
                        <h6 class="text-secondary mb-1">Today</h6>
                        <h5 class="fw-bold text-success mb-0">@Model.TodayVisits</h5>
                    </div>
                    <div class="col-md-4">
                        <h6 class="text-secondary mb-1">This Week</h6>
                        <h5 class="fw-bold text-warning mb-0">@Model.WeeklyVisits</h5>
                    </div>
                    <div class="col-md-4">
                        <h6 class="text-secondary mb-1">This Month</h6>
                        <h5 class="fw-bold text-primary mb-0">@Model.MonthlyVisits</h5>
                    </div>
                </div>
            </div>
        </div>






        <div class="col-md-6 col-xl-6 ">
            <div class="card border-0 rounded-3 p-3 yjo" style="background: linear-gradient(to right, #e4f1ff, #f0f4ff); box-shadow: rgba(50, 50, 93, 0.25) 0px 50px 100px -20px, rgba(0, 0, 0, 0.3) 0px 30px 60px -30px, rgba(10, 37, 64, 0.35) 0px -2px 6px 0px inset; height: 460px;">
                <h5 class="fw-semibold text-dark mb-2">📊 Year-wise Blog Posts</h5>
                <small class="text-muted mb-3 d-block">Number of blog posts uploaded per year</small>
                <div id="yearlyBarChart" style="height: 300px;"></div>
            </div>
        </div>


        

    
    </div>






    <!-- ApexCharts CDN -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

    <script>
        const options = {
            chart: {
                height: 260,
                type: 'line',
                stacked: false,
                toolbar: { show: false }
            },
            stroke: {
                width: [0, 3],
                curve: 'smooth'
            },
            series: [
                {
                    name: 'Visits (Bars)',
                    type: 'column',
                    data: [@Model.TodayVisits, @Model.WeeklyVisits, @Model.MonthlyVisits]
                },
                {
                    name: 'Trend (Line)',
                    type: 'line',
                    data: [@Model.TodayVisits, @Model.WeeklyVisits, @Model.MonthlyVisits]
                }
            ],
            xaxis: {
                categories: ['Today', 'This Week', 'This Month'],
                labels: {
                    style: {
                        fontSize: '13px',
                        colors: ['#2d3436']
                    }
                }
            },
            colors: ['#00b894', '#007bff'],
            markers: {
                size: 5,
                hover: { sizeOffset: 3 }
            },
            tooltip: {
                shared: true,
                intersect: false,
                theme: 'dark'
            },
            dataLabels: {
                enabled: true,
                enabledOnSeries: [1],
                style: {
                    fontSize: '12px',
                    colors: ['#007bff']
                }
            },
            plotOptions: {
                bar: {
                    columnWidth: '38%',
                    borderRadius: 6
                }
            },
            yaxis: {
                labels: {
                    style: {
                        fontSize: '12px',
                        colors: '#2f3542'
                    }
                }
            },
            grid: {
                borderColor: '#e0e0e0',
                strokeDashArray: 4
            },
            legend: {
                position: 'top',
                horizontalAlign: 'right',
                fontSize: '13px',
                labels: { colors: '#2d3436' }
            }
        };

        const chart = new ApexCharts(document.querySelector("#visitChart"), options);
        chart.render();
    </script>

    <script>
        const yearlyData = @Html.Raw(Json.Serialize(Model.YearWisePostCounts));

        const barChartOptions = {
            chart: {
                type: 'bar',
                height: 300
            },
            series: [{
                name: 'Posts',
                data: Object.values(yearlyData)
            }],
            xaxis: {
                categories: Object.keys(yearlyData),
                title: {
                    text: "Year"
                }
            },
            yaxis: {
                title: {
                    text: "Post Count"
                }
            },
            colors: ['#1e90ff'],
            dataLabels: {
                enabled: true
            }
        };

        const barChart = new ApexCharts(document.querySelector("#yearlyBarChart"), barChartOptions);
        barChart.render();
    </script>






</div>